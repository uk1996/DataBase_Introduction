## 1. 데이터베이스 시스템 정의

- 데이터베이스 시스템(DBS:DataBase System): 데이터베이스에 데이터를 저장하고, 저장된 데이터를 관리하여 조직에 필요한 정보를 생성해주는 시스템.

  #### DB, DBMS, DBS 차이점

  - 데이터베이스(DB): 데이터를 장해 두는곳, 즉 저장된 데이터의 집합
  - 데이터베이스 관리 시스템(DBMS): 데이터베이스에 저장된 데이터가 일관되고 무결한 상태로 유지되도록 관리하는 역할
  - 데이터베이스 시스템(DBS): 데이터베이스와 데이터베이스 관리 시스템을 이용해 조직에 필요한 정보를 제공해주는 전체 시스템. 데이터베이스와 데이터베이스 관리 시스템은 데이터베이스 시스템의 핵심 구성 요소

## 2. 데이터베이스의 구조

#### 1. 스키마(schema)

- 데이터베이스에 저장되는 데이터 구조와 제약조건을 정의한 것
- 정의된 스키마에 따라 데이터베이스에 실제로 저장된 값이 인스턴스(instance)다.
- 보통 스키마는 한번 정의되면 자주 변경되지 않지만, 인스턴스는 계속 변하는 특성이 있다.

#### 2. 3단계 데이터베이스 구조

- 3단계 데이터베이스 구조의 개념
  - 데이터베이스 구조는 하나의 데이터베이스를 세 단계로 나누어 이해
    - 외부 단계(external level): 개별 사용자 관점에서 바라보는 단계
    - 개념 단계(conceptual level): 조직 전체의 관점에서 바라보는 단계
    - 내부 단계(internal level): 물리적인 저장 장치의 관점에서 바라보는 단계
  - 각 단계별로 다른 추상화(abstraction)를 제공
  - 일반적으로 내부 단계에서 외부 단계로 갈수록 추상화 레벨이 높아진다.
  - 3단계 데이터베이스 구조를 통해, 모든 데이터의 저장/유지와 관련된 복잡한 내용을 숨기고 필요한 데이터만 단순화한 외부 단계의 관점을 일반 사용자들에게 제공할 수 있다.

<br/>

- 외부 단계(external level)

  - 개별 사용자 관점에서 데이터베이스를 이해하고 표현
  - 외부 단계에서는 개별 사용자가 데이터베이스를 어떻게 보는가를 표현하므로 사용자마다 생각하는 데이터베이스의 구조가 다르다.
  - 외부 단계에서 사용자에게 필요한 데이터베이스를 정의한 것을 외부 스키마(external schema)라 한다.
    - 외부 스키마는 각 사용자가 생각하는 데이터베이스의 모습을 표현한 논리적인 구조로, 사용자마다 다르다.
    - 하나의 데이터베이스에는 외부 스키마가 여러 개 존재할 수 있고, 외부 스키마 하나를 사용 목적이 같은 사용자들이 공유할 수 있다.
    - 외부 스키마는 전체 데이터베이스 중 사용자가 관심을 가지는 일부분으로 볼 수 있어 서브 스키마(sub schema)라고도 한다.

<br/>

- 개념 단계(conceptual level)
  - 데이터베이스를 이용하는 사용자들의 관점을 통합하여, 데이터베이스를 조직 전체의 관점에서 이해하고 표현
  - 데이터베이스 관리 시스템이나 관리자의 관점에서 모든 사용자에게 필요한 데이터를 통합하여 전체 데이터베이스의 논리적인 구조를 정의 => 개념 스키마(conceptual schema)
    - 개념 스키마는 조직 전체의 관점에서 생각하는 데이터베이스의 모습
    - 모든 개별 사용자가 생각하는 데이터베이스의 모습을 하나로 합친 형태
    - 개념 스키마는 전체 데이터베이스에 어떤 데이터가 저장되는지, 데이터들 간에는 어떤 관계가 존재하고 어떤 제약조건이 있는지에 대한 정의뿐만 아니라, 데이터에 대한 보안 정책이나 접근 권한에 대한 정의도 포함
    - 데이터를 물리적으로 저장하는 방법이나 데이터 저장 장치와는 독립적이다.
    - 하나의 데이터베이스에는 개념 스키마가 하나만 존재
    - 각 사용자는 개념 스키마의 일부분이 사용
    - 외부 스키마는 개념 스키마를 기초로 하여 사용자의 이용 목적에 맞게 만들어진다.
    - 일반적으로 스키마라고 하면 개념 스키마를 의미

<br/>

- 내부 단계(internal level)
  - 데이터베이스를 디스크나 테이프 같은 저장 장치의 관점에서 이해하고 표현
  - 내부단계에서는 전체 데이터베이스가 저장 장치에 실제로 저장되는 방법을 정의 => 내부 스키마(internal schema)
    - 데이터베이스는 저장 장치에 파일 형태로 저장되는데 내부 스키마는 파일에 데이터를 저장하는 레코드의 구조, 레코드를 구성하는 필드의 크기, 인덱스를 이용한 레코드 접근 경로 등을 정의
    - 내부 스키마는 데이터베이스의 개념 스키마에 대한 물리적인 저장 구조를 표현하므로 하나의 데이터베이스에 하나만 존재

#### 3. 데이터 독립성

- 스키마 사이의 대응 관계를 사상 또는 매핑(mapping)이라 한다.
  - 외부 스키마와 개념 스키마는 외부/개념 사상에 의해 대응되고, 개념 스키마와 내부 스키마는 개념/내부 사상에 의해 대응
  - 데이터베이스 관리 시스템은 미리 정의된 외부/개념 사상과 개념/내부 사상 정보를 이용해 사용자가 원하는 데이터에 접근할 수 있다.

<br/>

- 데이터베이스를 3단계 구조로 나누고, 단계별로 스키마를 유지하며 스키마 사이의 대응 관계를 정의하는 궁극적인 목적은 $데이터 독립성$(data independency)을 실현하기 위해서다.
  - 데이터 독립성은 하위 스키마를 변경하더라도 상위 스키마가 영향을 받지 않는 특성이다.
  - 3단계 데이터베이스 구조에는 논리적 데이터 독립성과 물리적 데이터 독립성이 존재

<br/>

- 논리적 데이터 독립성
  - 개념 스키마가 변경되더라도 외부 스키마가 영향을 받지 않는 것
  - 전체 데이터베이스의 논리적인 구조가 변경되어도 관련된 외부/개념 사상 정보만 적절히 수정해주면 직접 관련이 없는 사용자를 위한 외부 스키마는 변경할 필요가 없다.
- 물리적 데이터 독립성
  - 내부 스키마가 변경되더라도 개념 스키마가 영향을 받지 않는 것이다. 그래서 결과적으로 외부 스키마도 영향을 받지 않는다.
  - 데이터베이스의 저장 구조가 변경되어도 관련된 개념/내부 사상 정보만 적절히 수정해주면 직접적으로 관련이 없는 데이터베이스의 논리적 구조는 영향을 받지 않는다.

#### 4. 데이터 사전

- 데이터베이스는 조직 운영에 필요한 실제 데이터를 저장하는데, 저장된 데이터를 올바르게 관리하고 이용하려면 필요한 부가 정보도 저장해야 한다. 대표적인 부가 정보가 **스키마**와 **사상 정보**다.
- 데이터베이스에 저장되는 데이터에 관한 정보를 저장하는 곳을 **데이터 사전**(data dictionary) 또는 **시스템 카탈로그**(system catalog)라고 한다.
- 데이터 사전은 데이터베이스에 저장되어 있는 데이터를 정확하고 효율적으로 이용하기 위해 참고해야 되는 스키마, 사상 정보, 다양한 제약조건 등을 저장하고 있다.
- 데이터 사전은 데이터베이스 관리 시스템이 스스로 생성하고 유지하는 것으로, 데이터베이스 관리 시스템이 주로 접근하지만 일반 사용자도 접근 할 수 있다. 단, 데이터베이스 관리 시스템이 데이터 사전에 내용을 추가하거나 수정할 수 있느 반면, 사용자는 저장 내용을 검색만 할 수 있다.
- 데이터 사전에 있는 데이터에 실제로 접근하는 데 필요한 위치 정보는 $데이터 디렉터리$(data directory)라는 곳에 있다.
  - 데이터 사전과 데이터 디렉터리는 둘 다 시스템을 위한 데이터 베이스라는 공통점이 있지만, 데이터 사전은 사용자가 접근할 수 있고 데이터 디렉터리는 시스템만 접근할 수 있다는 차이가 있다.

## 3. 데이터베이스 사용자

- 데이터베이스 사용자
  - 데이터베이스 관리자: 데이터베이스 시스템을 운영하고 관리한다.
  - 최종 사용자(=일반 사용자): 데이터베이스에 접근하여 데이터를 조작한다.
  - 응용 프로그래머: 데이터 언어를 삽입하여 응용 프로그램을 작성한다.

#### 1. 데이터베이스 관리자(DBA: DataBase Administrator)

- 데이터베이스 시스템을 운영/관리한다.
- 데이터베이스를 직접 활용하기 보다는 조직 내의 사용자를 위해 데이터베이스를 설계 및 구축하고, 제대로 서비스할 수 있도록 데이터베이스를 제어한다.
- 주로 데이터 정의어와 데이터 제어어를 이용해 데이터베이스에 접근한다.
- 주요 업무
  - 데이터베이스 구성 요소 선정
  - 데이터베이스 스키마 정의
  - 물리적 저장 구조와 접근 방법 결정
  - 무결성 유지를 위한 제약조건 정의
  - 보안 및 접근 권한 정책 결정
  - 백업 및 회복 기법 정의
  - 시스템 데이터베이스 관리
  - 시스템 성능 감시 및 성능 분석
  - 데이터베이스 재구성

#### 2. 최종 사용자

- 데이터를 조작(삽입/수정/조회/삭제)하기 위해 데이터베이스에 접근하는 사람들
- 주로 데이터 조작어를 사용
- 캐주얼 사용자(casual end user)와 초보 사용자(naive end user)로 구분
  - 캐주얼 사용자: 데이터베이스에 대한 이론적 지식이 있으며, 주로 데이터 조작어를 이용해 원하는 데이터와 데이터데 대한 처리를 데이터베이스 관리 시스템에 직접 설명
  - 초보 사용자: GUI 형태의 응용 프로그램을 통해 데이터베이스를 사용

#### 3. 응용 프로그래머(application programmer)

- C 언어, 자바등과 같은 프로그래밍 언어로 응용 프로그램을 작성할때 데이터베이스에 접근하는 데이터 조작어를 삽입하는 사용자
- 주로 데이터 조작어를 삽입
- 최종 사용자는 응용 프로그래머가 작성한 응용 프로그램을 이용해 데이터베이스에 접근할 수 있다.

## 4. 데이터 언어

- 데이터 언어(data language): 사용자가 데이터베이스를 구축하고 이에 접근하기 위해 데이터베이스 관리 시스템과 통신하는 수단.
  - 데이터 정의어(DDL): 스키마를 정의하거나, 수정 또는 삭제하기 위해서 사용한다.
  - 데이터 조작어(DML): 데이터의 삽입/삭제/수정/검색 등의 처리를 요구하기 위해서 사용한다.
  - 데이터 제어어(DCL): 내부적으로 필요한 규칙이나 기법을 정의하기 위해서 사용한다.

#### 1. 데이터 정의어(DDL: Data Definition Language)

- 새로운 데이터베이스를 구축하기 위해 스키마를 정의하거나 기존 스키마의 정의를 삭제 또는 수정하기 위해 사용하는 데이터 언어
- 데이터 정의어로 정의된 스키마는 데이터 사전에 저장되고, 삭제나 수정이 발생하면 이 내용도 데이터 사전에 반영된다.
  - 데이터 사전에 저장된 스키마 정보는 사용자나 데이터베이스 관리 시스템이 필요할때 참고할 수 있다.

#### 2.데이터 조작어(DML: Data Manipulation Language)

- 사용자가 데이터의 삽입/삭제/수정/검색 등의 처리를 데이터베이스 관리 시스템에 요구하기 위해 사용하는 데이터 언어
- 데이터 조작어는 설명 방식에 따라 절차적 데이터 조작어와 비절차적 데이터 조작어로 나뉜다.
  - 절차적 데이터 조작어: 사용자가 어떤(what) 데이터를 원하고 해당 데이터를 얻으려면 어떻게(how) 처리해야 하는지를 구체적으로 설명
  - 비절차적 데이터 조작어: 사용자가 어떤 데이터를 원하는지만 설명한다. 즉, 데이터를 얻으려면 어떻게 처리해야 하는지는 데이터베이스 관리 시스템에 맡긴다.
  - 선언적 언어 라고도 한다.

#### 3. 데이터 제어어(Data Control Language)

- 데이터베이스에 저장된 데이터를 여러 사용자가 무결성과 일관성을 유지하며 유지하며 문제없이 공유할 수 있도록, 내부적으로 필요한 규칙이나 기법을 정의하는 데 사용하는 데이터 언어
- 데이터 제어어를 이용해 규칙이나 기법을 정의하는 이유는 다음과 같은 특성을 보장하기 위함이다.
  - 무결성(integrity): 데이터베이스에 정확하고 유효한 데이터만 유지한다.
  - 보안(security): 허가받지 않는 사용자가 데이터에 접근하는 것을 차단하거나, 허가된 사용자가 접근 권한이 있는 데이터에만 접근할수 있게 한다.
  - 회복(recovery): 장애가 발생해도 데이터의 일관성을 유지한다.
  - 동시성(concurrency): 여러 사용자가 같은 데이터에 동시에 접근하여 처리할 수 있게 한다.

<br/>

- 데이터 제어어는 원래 데이터 정의어로 분류되었지만, 데이터베이스 제어 기능이 중요해지고 다양한 제어 기능이 소개되면서 독립되었다.

## 5. 데이터베이스 관리 시스템의 구성

- 데이터 베이스 관리 시스템은 사용자와 데이터베이스 사이에 위치하며, 기능에 따라 크게 **질의 처리기**와 **저장 데이터 관리자**로 구분할 수 있다.

#### 1. 질의 처리기(query processor)

- 사용자의 데이터 처리 요구를 해석하여 처리하는 역할을 담담하고, 주요 구성 요소는 다음과 같다.
  - DDL 컴파일러(DDL compiler)
    - 데이터 정의어로 작성된 스키마의 정의 해석
    - 저장 데이터 관리자의 도움을 받아 새로운 데이터베이스를 구축하고, 스키마의 정의를 데이터 사전에 저장
  - DML 프리 컴파일러(DML precompiler): 응용 프로그램에 삽입된 데이터 조작어를 추출하여 DML컴파일러에 전달한다. 단, 데이터 조작어와 관련 없는 나머지 코드들은 해당 언어의 컴파일러에 보내진다.
  - DML 컴파일러(DML compiler): 데이터 조작어로 작성된 데이터의 처리(삽입/삭제/수정/검색) 요구를 분석하여 런타임 데이터베이스 처리기가 이해할 수 있도록 해석한다.
  - 런타임 데이터베이스 처리기(run-time database processor): 저장 데이터 관리자를 통해 데이터베이스에 접근하여, DML 컴파일러로부터 전달받은 처리 요구를 데이터베이스에서 실제로 실행한다.
  - 트랜잭션 관리자(transaction manager): 데이터베이스에 접근하는 과정에서 사용자의 접근 권한이 유효한지를 검사하고, 데이터베이스 무결성을 유지하기 위한 제약조건 위반 여부를 확인한다. 회복이나 병행 수행과 관련된 작업도 담당한다.

#### 2. 저장 데이터 관리자

- 디스크에 저장된 데이터베이스와 데이터 사전을 관리하고, 여기에 실제로 접근하는 역할을 담당한다.
- 디스크에 접근하는것은 운영체제의 기본 기능이므로 저장 데이터 관리자는 운영체제의 도움을 받아 데이터베이스에 대한 접근을 수행한다.
